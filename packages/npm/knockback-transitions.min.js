/*
  knockback-transitions.js 0.1.1
  (c) 2011, 2012 Kevin Malakoff - http://kmalakoff.github.com/knockback/
  License: MIT (http://www.opensource.org/licenses/mit-license.php)
  Dependencies: Knockout.js, Backbone.js, and Underscore.js.
*/(function(){return function(e){return typeof define=="function"&&define.amd?define("knockback-transitions",e):e.call(this)}(function(){var e,t,n,r,i;try{this.kb=n=!this.kb&&typeof require!="undefined"?require("knockback"):this.kb}catch(s){({})}this.kb||(this.kb=n||(n={})),n.transitions||(n.transitions={}),n.fallback_transitions||(n.fallback_transitions={}),n.transitions.END_EVENT=function(){var e,t,n,r;t=document.createElement("knockback"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",msTransition:"MSTransitionEnd",transition:"transitionend"};for(r in e){n=e[r];if(t.style[r]!==void 0)return n}return"kbTransitionEnd"}(),n.active_transitions=n.transitions.END_EVENT==="kbTransitionEnd"?n.fallback_transitions:n.transitions,$.fn.startTransition=function(e,t){var r,i=this;typeof e=="function"&&(t=e,e=null),r=function(){return i.off(n.transitions.END_EVENT,r),!t||t()},this.removeClass(e),this.one(n.transitions.END_EVENT,r),this.addClass(e),setTimeout(r,300)},$.fn.stopTransition=function(){this.trigger(n.transitions.END_EVENT)},t=function(e){var t,n,r,i;r={},i=e.style;for(t in i){n=i[t];if(!n)continue;r[t]=n}return r},n.TransitionSavedState=function(){function e(e){var t,n;this.el_states=[];for(n in e)t=e[n],!_.isElement(t)||this.el_states.push({el:t,className:t.className,cssText:t.style.cssText});return}return e.prototype.restore=function(){var e,t,n,r,i;i=this.el_states;for(n=0,r=i.length;n<r;n++)t=i[n],e=t.el,e.className=t.className,e.style.cssText=t.cssText;this.el_states=null},e}(),typeof exports!="undefined"&&(exports.TransitionSavedState=n.TransitionSavedState),n.transitions.SlideUp=function(e,t){if(!e.from){e.callback();return}$(e.to).css({height:$(e.container).height()}).startTransition(t.forward?"on-top slideup in":"on-top slideup out reverse",e.callback)},n.transitions.FadeIn=function(e,t){var n;n=$(e.to).css({"min-height":$(e.container).height()}),n.startTransition(t.forward?"on-top fade in":"on-top fade out",e.callback)},n.transitions.Slide=function(e,t){var n,r,i;if(!e.from){e.callback();return}i=$(e.container).width(),n=$(e.from).css({width:i}),r=$(e.to).css({width:i}),t.forward?(n.startTransition("slide out"),r.startTransition("slide in",e.callback)):(r.startTransition("slide out reverse"),n.startTransition("slide in reverse",e.callback))},e=n.FALLBACK_ANIMATION_DURATION=300,this.Zepto&&(r=function(e,t,n){return e.__kb_zepto_endEvent=typeof t=="string"?$.fx.animationEnd:$.fx.transitionEnd,e.__kb_zepto_callback=function(){if(!e.__kb_zepto_endEvent)return;return delete e.__kb_zepto_endEvent,delete e.__kb_zepto_callback,!n||n.call(this)},e.__kb_zepto_callback},i=$.fn.anim,$.fn.anim=function(e,t,n,s){var o,u,a,f;for(a=0,f=this.length;a<f;a++)o=this[a],u=r(o,e,s);return i.call(this,e,t,n,u),this},$.fn.stop=function(){var e,t,n;for(t=0,n=this.length;t<n;t++)e=this[t],e.__kb_zepto_endEvent&&$(e).trigger(e.__kb_zepto_endEvent);return this}),n.fallback_transitions.SlideUp=function(t,n){var r,i,s,o,u;if(!t.from){t.callback();return}r=$(t.to),i=function(){return r.stop(),t.callback()},s="duration"in n?n.duration:e,o=t.container.clientHeight,u=t.to.clientTop,n.forward?r.addClass("on-top").css({top:u+o}).animate({top:u},s,"linear",i):r.addClass("on-top").animate({top:u+o},s,"linear",i),r.startTransition(i)},n.fallback_transitions.FadeIn=function(t,n){var r,i;r=$(t.to).css({"min-height":$(t.container).height()}),i="duration"in n?n.duration:e,n.forward?(r.css({opacity:0}),r.animate({opacity:1},1e3,"swing",t.callback)):(r.css({opacity:1}),r.animate({opacity:0},1e3,"swing",t.callback)),r.startTransition(t.callback)},n.fallback_transitions.Slide=function(t,n){var r,i,s,o,u,a,f;if(!t.from){t.callback();return}return i=$(t.to),r=$(t.from),s=function(){return r.stop(),i.stop(),t.callback()},o="duration"in n?n.duration:e,f=$(t.container).width(),n.forward?(r.animate({left:t.from.clientLeft-f},o,"linear"),a=t.to.clientLeft,i.css({left:a+f}).animate({left:a},o,"linear",s)):(u=t.from.clientLeft,r.css({left:u-f}).animate({left:u},o,"linear"),i.animate({left:t.to.clientLeft+f},o,"linear",s)),i.startTransition(s)};return})}).call(this);